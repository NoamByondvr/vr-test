language: objective-c
osx_image: xcode7.2
install:
    - git submodule update --init --recursive
    - curl -o android-sdk.zip http://dl.google.com/android/android-sdk_r24.4.1-macosx.zip
    - unzip android-sdk.zip
    - export ANDROID_HOME=$PWD/android-sdk-macosx
    - export PATH=$PATH:$ANDROID_HOME/tools
    - export PATH=$PATH:$ANDROID_HOME/platform-tools
    - export JAVA_HOME=$(/usr/libexec/java_home)
    - echo "y" | android update sdk --no-ui --all --filter tool,platform-tool,android-19,build-tools-22.0.1
    - brew install ant
    - curl -o Unity.pkg http://download.unity3d.com/download_unity/3757309da7e7/MacEditorInstaller/Unity-5.2.2f1.pkg
    - sudo installer -dumplog -package Unity.pkg -target /
    - curl -o Unity-android.pkg http://download.unity3d.com/download_unity/3757309da7e7/MacEditorTargetInstaller/UnitySetup-Android-Support-for-Editor/Unity-5.2.2f1.pkg
    - sudo installer -dumplog -package Unity-android.pkg -target /
script:
    - ./Scripts/build.sh
deploy:
    provider: s3
    access_key_id: $AWS_ACCESS_KEY_ID
    secret_access_key: $AWS_SECRET_ACCESS_KEY
    bucket: travis-build-test
    skip_cleanup: true
    acl: public_read
    local_dir: Build